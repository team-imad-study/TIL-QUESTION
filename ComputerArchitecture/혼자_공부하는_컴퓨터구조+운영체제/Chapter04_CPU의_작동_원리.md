# DAY02
작성일 : 2024/03/08

> 범위
- ALU와 제어장치
- 레지스터

---

> 작성자 : 

---

> 작성자 : NCookie

## 베이스 레지스터 주소 지정 방식의 용도 (Ch04-2)

### 배열(Array) 접근

배열의 첫 번째 요소의 주소를 베이스 레지스터에 저장하고, 오프셋(offset)을 더해 원하는 요소에 접근할 수 있다.

```assembly
; 배열의 주소를 베이스 레지스터에 저장
MOV R2, #base_address_of_array

; 원하는 인덱스 계산
MOV R3, #index
MUL R3, R3, #element_size ; 요소의 크기를 곱해 오프셋 계산

; 베이스 레지스터와 오프셋을 합쳐 실제 주소 계산
ADD R2, R2, R3

; 해당 주소의 데이터에 접근
MOV R1, [R2]
```

이렇게 하면 배열에서 index에 해당하는 요소에 접근할 수 있다. base_address_of_array는 배열의 시작 주소이고, index는 원하는 요소의 인덱스다. element_size는 배열의 각 요소의 크기를 나타낸다.

### 구조체(Struct) 접근

구조체의 필드에 접근하는 경우에도 베이스 레지스터 주소 지정 방식이 유용하다. 구조체의 시작 주소를 베이스 레지스터에 저장하고 필드의 오프셋을 더하여 필드에 접근할 수 있다.

```assembly
; 구조체의 시작 주소를 베이스 레지스터에 저장
MOV R2, #base_address_of_struct

; 필드의 오프셋 계산
MOV R3, #offset_of_field

; 베이스 레지스터와 오프셋을 합쳐 필드의 주소 계산
ADD R2, R2, R3

; 해당 필드의 데이터에 접근
MOV R1, [R2]
```

여기서 base_address_of_struct는 구조체의 시작 주소이고, offset_of_field는 접근하려는 필드의 오프셋을 나타낸다. 이 방식을 사용하면 구조체의 특정 필드에 쉽게 접근할 수 있다.

### 함수 인자(Arguments) 전달

베이스 레지스터 주소 지정 방식은 함수에 인자를 전달할 때도 유용하다. 함수 호출 시 인자들을 레지스터에 저장하고 함수가 호출될 때 베이스 레지스터를 통해 인자들에 접근할 수 있다.

```assembly
; 함수에 전달할 인자들을 레지스터에 저장
MOV R1, #arg1
MOV R2, #arg2

; 함수 호출 시 베이스 레지스터에 인자들의 주소 저장
MOV R3, #base_address_of_args
STR R1, [R3]
ADD R3, R3, #4 ; 다음 인자의 위치로 이동
STR R2, [R3]

; 함수 호출
BL function_name
```

이 경우 base_address_of_args는 함수에 전달할 인자들의 주소를 가리킨다. 함수가 호출되면 베이스 레지스터를 통해 인자들의 값을 전달할 수 있다.

이러한 예시에서 보듯이 베이스 레지스터 주소 지정 방식은 주로 메모리에 접근할 때 특정 위치를 기준으로 계산할 때 사용된다. 배열, 구조체, 함수 인자 등의 다양한 상황에서 유용하게 쓰일 수 있다.

---
